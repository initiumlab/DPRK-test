function post(a,b){"use strict";var c="http://3cf586cb.ngrok.com/remember/dprktest2015/",d=new XMLHttpRequest,e={username:nkoreaTest.uuid,key:a,value:b,raw:"",datetime:Date.now()};d.open("POST",c,!0),d.setRequestHeader("Content-Type","application/json; charset=UTF-8");var f=JSON.stringify(e);d.send(f),console.log("posted "+f)}nkoreaTest.setNewUUID=function(){"use strict";if(localStorage.getItem("uuid"))this.uuid=localStorage.getItem("uuid");else{var a="http://3cf586cb.ngrok.com/utility/uuid/",b="DEFAULT",c=new XMLHttpRequest;c.open("GET",a,!0),c.onload=function(){if(console.log("UUID server responded"),c.status>=200&&c.status<400){var a=JSON.parse(c.responseText);a.success&&(b=a.data.uuid)}c.send(),this.uuid=b,localStorage.setItem("uuid",b)}.bind(this),c.send()}};var Banner=React.createClass({displayName:"Banner",render:function(){return React.createElement("div",{id:"Banner"},React.createElement("img",{id:"BannerImage",src:nkoreaTest.bannerImgRelativePath}))}}),QuestionPanel=React.createClass({displayName:"QuestionPanel",handleCheckboxClick:function(a,b){nkoreaTest.Card.state.chosenOptionTag=a,nkoreaTest.Card.setState({showAnswer:!0}),a===this.props.data.correctOptionTag&&(nkoreaTest.totalScore+=nkoreaTest.scorePerQuestion);for(var c=document.getElementsByClassName("checkbox"),d=0;d<c.length;d+=1)c[d].disabled=!0;post(nkoreaTest.Card.state.questionSerial.toString(),a)},getCorrectnessSign:function(a){if(a!==nkoreaTest.Card.state.chosenOptionTag)return"";var b,c,d=nkoreaTest.survey[nkoreaTest.Card.state.questionSerial].correctOptionTag;b=null===nkoreaTest.Card.state.chosenOptionTag?"":nkoreaTest.Card.state.chosenOptionTag===d?"✓":"✕";var e=document.getElementsByClassName("CorrectnessSign");if("✓"===b)for(c=0;c<e.length;c+=1)e[c].className="CorrectnessSign CorrectnessSign-correct";else if("✕"===b)for(c=0;c<e.length;c+=1)e[c].className="CorrectnessSign CorrectnessSign-wrong";return b},render:function(){if(!(nkoreaTest.Card.state.answerSerial>=nkoreaTest.survey.length)){var a;return a=this.props.data.optionContainsImage?this.props.data.options.map(function(a){var b="";return"D"===a.optionTag&&(b=" optionBoxWithImageWide"),React.createElement("div",{className:"optionBox optionBoxWithImage"+b,key:a.optionTag},React.createElement("label",{className:"WithImage"},React.createElement("div",{className:"optionBoxLeftContainer"},React.createElement("input",{type:"checkbox",name:a.optionTag,onChange:this.handleCheckboxClick.bind(this,a.optionTag),className:"checkbox"}),React.createElement("span",{className:"optionTag"},a.optionTag)),React.createElement("img",{src:a.imagePath,className:"insertImage"}),React.createElement("div",{className:"optionBoxRightContainer"},React.createElement("span",{className:"optionText optionTextWithImage"},a.optionText),React.createElement("span",{className:"CorrectnessSign"},this.getCorrectnessSign(a.optionTag)))))},this):this.props.data.options.map(function(a){return React.createElement("div",{className:"optionBox",key:a.optionTag},React.createElement("label",null,React.createElement("input",{type:"checkbox",name:a.optionTag,onChange:this.handleCheckboxClick.bind(this,a.optionTag),className:"checkbox"}),React.createElement("span",{className:"optionTag"},a.optionTag),React.createElement("span",{className:"optionText"},a.optionText),React.createElement("span",{className:"CorrectnessSign"},this.getCorrectnessSign(a.optionTag))))},this),React.createElement("div",{id:"QuestionPanel",data:this.props.data},React.createElement("div",{id:"questionTag"},this.props.data.questionTag),React.createElement("div",{id:"questionText"},this.props.data.questionText),React.createElement("div",{id:"OptionPanel"},a))}}}),AnswerPanel=React.createClass({displayName:"AnswerPanel",handleNextButtonClick:function(a){post(nkoreaTest.Card.state.questionSerial.toString(),"Next"),nkoreaTest.Card.setState({questionSerial:nkoreaTest.Card.state.questionSerial+1,answerSerial:nkoreaTest.Card.state.answerSerial+1,showAnswer:!1}),nkoreaTest.Card.state.questionSerial===nkoreaTest.survey.length-2&&nkoreaTest.Card.setState({lastQuestion:!0}),nkoreaTest.Card.state.questionSerial>=nkoreaTest.survey.length-1&&(React.render(React.createElement(ScorePage,null),document.getElementById("content")),post("result",nkoreaTest.totalScore.toString()));for(var b=document.getElementsByClassName("checkbox"),c=0;c<b.length;c+=1)b[c].checked=!1,b[c].disabled=!1;nkoreaTest.Card.state.chosenOptionTag=null},render:function(){return React.createElement("div",{id:"AnswerPanel",data:this.props.data,key:0},React.createElement("div",{className:"ExplanationBox"},React.createElement("div",{className:"answerBox"},React.createElement("div",{className:"answerInnerBox"},React.createElement("span",{className:"answerLabel"},nkoreaTest.text.answerLabel),React.createElement("span",{className:"answerTag"},this.props.data.correctOptionTag))),React.createElement("span",{className:"Explanation"},this.props.data.ExplanationText),React.createElement("button",{id:"next",onClick:this.handleNextButtonClick},nkoreaTest.Card.state.lastQuestion?nkoreaTest.text.lastButtonLabel:nkoreaTest.text.nextButtonLabel)))}}),Card=React.createClass({displayName:"Card",getInitialState:function(){return{questionSerial:0,answerSerial:0,showAnswer:!1,chosenOptionTag:null,lastQuestion:!1}},render:function(){return nkoreaTest.Card=this,React.createElement("div",{id:"Card",surveyData:this.props.surveyData},React.createElement(Banner,null),React.createElement(QuestionPanel,{data:this.props.surveyData[this.state.questionSerial]}),this.state.showAnswer?React.createElement(AnswerPanel,{data:this.props.surveyData[this.state.answerSerial]}):null)}}),ScorePage=React.createClass({displayName:"ScorePage",shareToWeibo:function(){var a=encodeURIComponent(nkoreaTest.text.scoreDescription+nkoreaTest.totalScore.toString()+nkoreaTest.text.shareHint);encodeURIComponent(nkoreaTest.url);window.open("http://v.t.sina.com.cn/share/share.php?title="+a+"&url="+nkoreaTest.url),post("share","weibo")},shareToFacebook:function(){var a=encodeURIComponent(nkoreaTest.text.scoreDescription+nkoreaTest.totalScore.toString()+nkoreaTest.text.shareHint),b=encodeURIComponent(nkoreaTest.url);window.open("https://www.facebook.com/dialog/feed?app_id=743206445788490+&link="+b+"&picture="+nkoreaTest.url+nkoreaTest.shareImgRelativePath+"&name="+nkoreaTest.title+"&description="+a+"&redirect_uri="+b),post("share","facebook")},componentDidMount:function(){document.getElementById("marketingInfobox").innerHTML=nkoreaTest.text.marketingInfoboxInnerHTML},render:function(){var a=nkoreaTest.scoreComments[nkoreaTest.totalScore.toString()];return React.createElement("div",{id:"ScorePage"},React.createElement(Banner,null),React.createElement("h1",null,"你的總分是：",nkoreaTest.totalScore),React.createElement("p",null,a),React.createElement("button",{className:"share Facebook-Share-btn",onClick:this.shareToFacebook},React.createElement("img",{src:"img/FB-f-Logo__blue_50.png"}),nkoreaTest.text.facebookShareButtonText),React.createElement("button",{className:"share Weibo-Share-btn",onClick:this.shareToWeibo},React.createElement("img",{src:"img/weibo_48x48.png"}),nkoreaTest.text.ShareToWeiboText),React.createElement("div",{className:"fulltextRecommendation"},nkoreaTest.text.fulltextRecommendation,React.createElement("a",{href:"https://theinitium.com/project/20150803-dprk-youth/",target:"_blank"},nkoreaTest.text.linkLabel)),React.createElement("div",{id:"marketingInfobox"}))}});document.title=nkoreaTest.title,nkoreaTest.setNewUUID(),React.render(React.createElement(Card,{surveyData:nkoreaTest.survey}),document.getElementById("content")),post("render",nkoreaTest.lang+"-rendered");